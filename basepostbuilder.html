<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Base Post Generator â€” Canvas PNG</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
* { box-sizing: border-box; }

body {
  margin: 0;
  background: #f5f5f5;
  padding: 32px;
  display: flex;
  justify-content: center;
  font-family: system-ui;
}

main {
  display: flex;
  gap: 24px;
  flex-wrap: wrap;
  width: 100%;
  max-width: 1200px;
}

.panel {
  flex: 0 0 360px;
  background: #fff;
  border-radius: 16px;
  padding: 16px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.05);
  max-height: 90vh;
  overflow-y: auto;
}

.section { margin-bottom: 20px; }
.section h3 {
  margin: 0 0 8px;
  font-size: 16px;
  font-weight: 600;
  border-bottom: 1px solid #ddd;
}

label {
  font-size: 13px;
  font-weight: 600;
  display: block;
  margin-top: 8px;
}

input, textarea, select {
  width: 100%;
  padding: 10px;
  border-radius: 10px;
  border: 1px solid #ccc;
}

textarea { min-height: 80px; }

.selector {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 8px;
}

.selector img {
  width: 100%;
  border-radius: 8px;
  cursor: pointer;
  border: 2px solid transparent;
}

.selector img.selected {
  border-color: #1da1f2;
}

.preview-wrapper {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
}

canvas {
  width: 600px;
  height: 600px;
  border-radius: 16px;
  box-shadow: 0 4px 16px rgba(0,0,0,0.15);
  background: #000;
}

button {
  margin-top: 16px;
  width: 600px;
  padding: 12px;
  border-radius: 10px;
  border: none;
  background: #1da1f2;
  color: #fff;
  font-weight: 600;
  cursor: pointer;
}
</style>
</head>

<body>
<main>

<section class="panel">
  <h2>Base Post Generator</h2>

  <div class="section">
    <h3>Headline</h3>
    <input id="headline" value="Building for builders">
    <input type="color" id="headlineColor" value="#ffffff">
    <select id="headlineFont">
      <option>Inter</option>
      <option>IBM Plex Sans</option>
      <option>Space Grotesk</option>
      <option>DM Sans</option>
      <option value="system-ui">System UI</option>
    </select>
  </div>

  <div class="section">
    <h3>Body</h3>
    <textarea id="body">Composable tools for the Base ecosystem.</textarea>
    <input type="color" id="bodyColor" value="#ffffff">
    <select id="bodyFont">
      <option>Inter</option>
      <option>IBM Plex Sans</option>
      <option>Space Grotesk</option>
      <option>DM Sans</option>
      <option value="system-ui">System UI</option>
    </select>
  </div>

  <div class="section">
    <h3>Template</h3>
    <div class="selector" id="templateSelector"></div>
  </div>

  <div class="section">
    <h3>Logo</h3>
    <div class="selector" id="logoSelector"></div>
  </div>
</section>

<section class="preview-wrapper">
  <canvas id="card" width="1000" height="1000"></canvas>
  <button id="sharePNG">Share PNG</button>
</section>

</main>

<script>
// ===== FONTS =====
const FONT_FILES = {
  "Inter": "assets/fonts/Inter-Regular.woff2",
  "IBM Plex Sans": "assets/fonts/IBMPlexSans-Regular.woff2",
  "Space Grotesk": "assets/fonts/SpaceGrotesk-Regular.woff2",
  "DM Sans": "assets/fonts/DMSans-Regular.woff2"
};

async function loadFont(name) {
  if (name === "system-ui") return;
  if ([...document.fonts].some(f => f.family === name)) return;
  const font = new FontFace(name, `url(${FONT_FILES[name]})`);
  await font.load();
  document.fonts.add(font);
}

// ===== CANVAS =====
const canvas = document.getElementById("card");
const ctx = canvas.getContext("2d");

// ===== STATE =====
let templateImg = new Image();
let logoImg = new Image();

let state = {
  headline: "Building for builders",
  body: "Composable tools for the Base ecosystem.",
  headlineFont: "Inter",
  bodyFont: "Inter",
  headlineColor: "#fff",
  bodyColor: "#fff"
};

// ===== RENDER =====
async function render() {
  await loadFont(state.headlineFont);
  await loadFont(state.bodyFont);

  ctx.clearRect(0,0,1000,1000);

  if (templateImg.complete) ctx.drawImage(templateImg,0,0,1000,1000);

  ctx.fillStyle = state.headlineColor;
  ctx.font = `700 64px '${state.headlineFont}'`;
  ctx.textAlign = "center";
  ctx.fillText(state.headline,500,260);

  ctx.fillStyle = state.bodyColor;
  ctx.font = `400 32px '${state.bodyFont}'`;
  ctx.fillText(state.body,500,340);

  if (logoImg.complete) ctx.drawImage(logoImg,720,780,160,160);
}

// ===== TEMPLATES =====
const templates = [
  "assets/templates/blue.png",
  "assets/templates/black.png",
  "assets/templates/blackandblue.png",
  "assets/templates/blackandwhite.png"
];

const templateSelector = document.getElementById("templateSelector");
templates.forEach((src,i)=>{
  const img = document.createElement("img");
  img.src = src;
  img.onclick = ()=>{
    templateImg.src = src;
    render();
    document.querySelectorAll("#templateSelector img").forEach(i=>i.classList.remove("selected"));
    img.classList.add("selected");
  };
  if(i===0){ img.classList.add("selected"); templateImg.src = src; }
  templateSelector.appendChild(img);
});

// ===== LOGOS =====
const logos = [
  "assets/logos/Base_blue.png",
  "assets/logos/Base_black.png",
  "assets/logos/Base_white.png"
];

const logoSelector = document.getElementById("logoSelector");
logos.forEach((src,i)=>{
  const img = document.createElement("img");
  img.src = src;
  img.onclick = ()=>{
    logoImg.src = src;
    render();
    document.querySelectorAll("#logoSelector img").forEach(i=>i.classList.remove("selected"));
    img.classList.add("selected");
  };
  if(i===0){ img.classList.add("selected"); logoImg.src = src; }
  logoSelector.appendChild(img);
});

// ===== INPUTS =====
headline.oninput = e => { state.headline = e.target.value; render(); };
body.oninput = e => { state.body = e.target.value; render(); };
headlineFont.onchange = e => { state.headlineFont = e.target.value; render(); };
bodyFont.onchange = e => { state.bodyFont = e.target.value; render(); };
headlineColor.oninput = e => { state.headlineColor = e.target.value; render(); };
bodyColor.oninput = e => { state.bodyColor = e.target.value; render(); };

// ===== SHARE PNG =====
sharePNG.onclick = () => {
  const url = canvas.toDataURL("image/png");
  const win = window.open();
  win.document.write(`<img src="${url}" />`);
};

templateImg.onload = render;
logoImg.onload = render;
</script>

</body>
</html>
