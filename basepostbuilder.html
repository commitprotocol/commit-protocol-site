<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Base Post Generator - Pixel Perfect</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=IBM+Plex+Sans:wght@400;600&family=Space+Grotesk:wght@400;600&family=DM+Sans:wght@400;600&display=swap" rel="stylesheet">

<style>
* { box-sizing: border-box; }
body {
  margin: 0;
  font-family: Inter, system-ui, sans-serif;
  background: #f5f5f5;
  padding: 32px;
  display: flex;
  justify-content: center;
}
main {
  display: flex;
  gap: 24px;
  flex-wrap: wrap;
  width: 100%;
  max-width: 1200px;
}
.panel {
  flex: 0 0 360px;
  background: #fff;
  border-radius: 16px;
  padding: 16px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.05);
  max-height: 90vh;
  overflow-y: auto;
}
.section { margin-bottom: 20px; }
.section h3 {
  margin-top: 0;
  font-size: 16px;
  font-weight: 600;
  border-bottom: 1px solid #ddd;
  padding-bottom: 4px;
  margin-bottom: 8px;
}
label { font-size: 13px; font-weight: 600; display: block; margin-top: 8px; }
input, textarea, select {
  width: 100%;
  padding: 10px 12px;
  border-radius: 10px;
  border: 1px solid #ccc;
  font-size: 14px;
}
textarea { min-height: 80px; }
.selector {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 8px;
  margin-top: 8px;
}
.selector img {
  width: 100%;
  border-radius: 8px;
  border: 2px solid transparent;
  cursor: pointer;
  transition: all 0.2s;
}
.selector img:hover { transform: scale(1.05); }
.selector img.selected {
  border-color: #1da1f2;
  box-shadow: 0 0 8px rgba(29,161,242,0.5);
}
.preview-wrapper {
  flex: 1 1 600px;
  display: flex;
  flex-direction: column;
  align-items: center;
}
.card {
  width: 100%;
  max-width: 600px;
  border-radius: 16px;
  overflow: hidden;
  box-shadow: 0 4px 16px rgba(0,0,0,0.1);
}
button {
  padding: 10px 16px;
  background: #1da1f2;
  color: #fff;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  font-weight: 600;
  width: 100%;
  margin-top: 16px;
}
.slider-wrapper { display: flex; align-items: center; gap: 8px; }
.slider-wrapper span { width: 32px; text-align: center; font-size: 13px; }
</style>
</head>

<body>
<main>

<section class="panel">
  <h2>Base Post Generator</h2>

  <div class="section">
    <h3>User Logo / PFP</h3>
    <input type="file" id="userLogoInput" accept="image/*">
    <label>Width</label>
    <input type="number" id="userLogoWidth" value="100">
    <label>Height</label>
    <input type="number" id="userLogoHeight" value="100">
  </div>

  <div class="section">
    <h3>Headline</h3>
    <input id="headline" value="Building for builders">
    <input type="color" id="headlineColor" value="#ffffff">
    <input type="range" id="headlineSize" min="24" max="100" value="48">
  </div>

  <div class="section">
    <h3>Body</h3>
    <textarea id="body"></textarea>
    <input type="color" id="bodyColor" value="#ffffff">
    <input type="range" id="bodySize" min="14" max="60" value="28">
  </div>

  <div class="section">
    <h3>Footer</h3>
    <input id="footer" value="Permissionless by design">
    <input type="color" id="footerColor" value="#ffffff">
    <input type="range" id="footerSize" min="10" max="40" value="16">
  </div>

  <div class="section">
    <h3>Fonts</h3>
    <select id="headlineFont">
      <option>Inter</option>
      <option>IBM Plex Sans</option>
      <option>Space Grotesk</option>
      <option>DM Sans</option>
    </select>
    <select id="bodyFont">
      <option>Inter</option>
      <option>IBM Plex Sans</option>
      <option>Space Grotesk</option>
      <option>DM Sans</option>
    </select>
  </div>

  <div class="section">
    <h3>Template</h3>
    <div class="selector" id="templateSelector"></div>
  </div>

  <div class="section">
    <h3>Logo</h3>
    <div class="selector" id="logoSelector"></div>
    <select id="logoPosition">
      <option value="bottom-right">Bottom Right</option>
      <option value="bottom-left">Bottom Left</option>
      <option value="bottom-center">Bottom Center</option>
    </select>
  </div>
</section>

<section class="preview-wrapper">
  <div class="card">
    <svg id="svgCard" viewBox="0 0 1000 1000" xmlns="http://www.w3.org/2000/svg">
      <rect width="1000" height="1000" fill="#fff"/>
      <g id="svgTemplate"></g>
      <image id="svgUserLogo" x="450" y="100" width="100" height="100"/>
      <text id="svgHeadline" x="500" y="260" text-anchor="middle" font-size="48" fill="#fff">Building for builders</text>
      <text id="svgBody" x="500" y="330" text-anchor="middle"></text>
      <text id="svgFooter" x="500" y="820" text-anchor="middle" font-size="16" fill="#fff">Permissionless by design</text>
      <g id="svgLogo"></g>
    </svg>
  </div>

  <button id="sharePNG">Share PNG</button>
</section>

<script src="https://cdn.jsdelivr.net/npm/canvg@4.0.24/lib/umd.min.js"></script>

<script>
const templates = [
  "assets/templates/blue.svg",
  "assets/templates/black.svg",
  "assets/templates/blackandblue.svg",
  "assets/templates/blackandwhite.svg"
];
const logos = [
  "assets/logos/Base_blue.svg",
  "assets/logos/Base_black.svg",
  "assets/logos/Base_white.svg"
];

const svgTemplate = document.getElementById("svgTemplate");
const svgLogo = document.getElementById("svgLogo");
const svgCard = document.getElementById("svgCard");

async function inlineSVG(url, target, transform="") {
  const res = await fetch(url);
  const text = await res.text();
  const svg = new DOMParser().parseFromString(text,"image/svg+xml").querySelector("svg");
  target.innerHTML = "";
  while(svg.childNodes.length) target.appendChild(svg.childNodes[0]);
  if(transform) target.setAttribute("transform", transform);
}

templates.forEach((src,i)=>{
  const img = document.createElement("img");
  img.src = src;
  img.onclick = ()=>inlineSVG(src, svgTemplate);
  if(i===0) inlineSVG(src, svgTemplate);
  document.getElementById("templateSelector").appendChild(img);
});

logos.forEach((src,i)=>{
  const img = document.createElement("img");
  img.src = src;
  img.onclick = ()=>inlineSVG(src, svgLogo, "translate(720 780) scale(0.16)");
  if(i===0) inlineSVG(src, svgLogo, "translate(720 780) scale(0.16)");
  document.getElementById("logoSelector").appendChild(img);
});

document.getElementById("sharePNG").onclick = ()=>{
  const win = window.open("", "_blank");
  win.document.write("<p>Gerando imagemâ€¦</p>");
  setTimeout(async ()=>{
    const svgData = new XMLSerializer().serializeToString(svgCard);
    const canvas = document.createElement("canvas");
    canvas.width = 1000;
    canvas.height = 1000;
    const ctx = canvas.getContext("2d");
    const v = await Canvg.fromString(ctx, svgData);
    await v.render();
    win.document.body.innerHTML = `<img src="${canvas.toDataURL()}" style="max-width:90%;display:block;margin:auto">`;
  },50);
};
</script>

</body>
</html>
