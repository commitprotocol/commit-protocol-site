<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Base Post Generator</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{box-sizing:border-box}
body{
  margin:0;
  padding:24px;
  background:#f4f4f4;
  display:flex;
  justify-content:center;
}
main{
  display:flex;
  gap:24px;
  width:100%;
  max-width:1200px;
}
.panel{
  width:360px;
  background:#fff;
  border-radius:16px;
  padding:16px;
  box-shadow:0 4px 12px rgba(0,0,0,.08);
  overflow-y:auto;
}
.section{margin-bottom:20px}
.section h3{
  margin:0 0 8px;
  font-size:15px;
  border-bottom:1px solid #ddd;
}
label{font-size:12px;font-weight:600}
input,textarea,select{
  width:100%;
  margin-top:6px;
  padding:8px 10px;
  border-radius:8px;
  border:1px solid #ccc;
}
textarea{min-height:80px}
.selector{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:8px;
}
.selector img{
  width:100%;
  border-radius:8px;
  cursor:pointer;
  border:2px solid transparent;
}
.selector img.selected{
  border-color:#1da1f2;
}
.preview{
  flex:1;
  display:flex;
  flex-direction:column;
  align-items:center;
}
.card{
  width:100%;
  max-width:520px;
  background:#000;
  border-radius:16px;
  overflow:hidden;
}
canvas{
  width:100%;
  height:auto;
  display:block;
}
button{
  margin-top:16px;
  width:100%;
  padding:10px;
  border:none;
  border-radius:8px;
  background:#1da1f2;
  color:#fff;
  font-weight:600;
  cursor:pointer;
}

/* fonts */
@font-face{font-family:Inter;src:url("assets/fonts/Inter-Regular.woff2") format("woff2");font-display:swap}
@font-face{font-family:"IBM Plex Sans";src:url("assets/fonts/IBMPlexSans-Regular.woff2") format("woff2");font-display:swap}
@font-face{font-family:"Space Grotesk";src:url("assets/fonts/SpaceGrotesk-Regular.woff2") format("woff2");font-display:swap}
@font-face{font-family:"DM Sans";src:url("assets/fonts/DMSans-Regular.woff2") format("woff2");font-display:swap}
</style>
</head>

<body>
<main>

<section class="panel">
  <div class="section">
    <h3>Headline</h3>
    <input id="headline" value="Building for builders">
    <input type="color" id="headlineColor">
    <select id="headlineFont">
      <option>Inter</option>
      <option>IBM Plex Sans</option>
      <option>Space Grotesk</option>
      <option>DM Sans</option>
      <option value="system-ui">System UI</option>
    </select>
  </div>

  <div class="section">
    <h3>Body</h3>
    <textarea id="body"></textarea>
    <input type="color" id="bodyColor">
    <select id="bodyFont">
      <option>Inter</option>
      <option>IBM Plex Sans</option>
      <option>Space Grotesk</option>
      <option>DM Sans</option>
      <option value="system-ui">System UI</option>
    </select>
  </div>

  <div class="section">
    <h3>Template</h3>
    <div class="selector" id="templateSelector"></div>
  </div>

  <div class="section">
    <h3>Base Logo</h3>
    <div class="selector" id="logoSelector"></div>
  </div>
</section>

<section class="preview">
  <div class="card">
    <canvas id="canvas" width="1000" height="1000"></canvas>
  </div>
  <button id="sharePNG">Share PNG</button>
</section>

</main>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

const state = {
  template:null,
  templateTheme:"dark",
  logo:null,
  headline:"Building for builders",
  body:"",
  headlineColor:"#ffffff",
  bodyColor:"#ffffff",
  headlineFont:"Inter",
  bodyFont:"Inter"
};

const templates = [
  {src:"assets/templates/black.png",theme:"dark"},
  {src:"assets/templates/blue.png",theme:"dark"},
  {src:"assets/templates/blackandblue.png",theme:"dark"},
  {src:"assets/templates/blackandwhite.png",theme:"light"}
];

const logos=[
  "assets/logos/Base_blue.png",
  "assets/logos/Base_black.png",
  "assets/logos/Base_white.png",
  "assets/logos/Base_blue2.png",
  "assets/logos/Base_black2.png",
  "assets/logos/Base_white2.png"
];

const images = {};

function loadImage(src){
  return new Promise(r=>{
    const i=new Image();
    i.onload=()=>{images[src]=i;r()};
    i.src=src;
  });
}

async function ensureFonts(){
  await Promise.all([
    document.fonts.load("48px Inter"),
    document.fonts.load("48px IBM Plex Sans"),
    document.fonts.load("48px Space Grotesk"),
    document.fonts.load("48px DM Sans")
  ]);
}

async function draw(){
  ctx.clearRect(0,0,1000,1000);

  if(state.template)
    ctx.drawImage(images[state.template],0,0,1000,1000);

  ctx.textAlign="center";

  ctx.fillStyle=state.headlineColor;
  ctx.font=`700 56px ${state.headlineFont}`;
  ctx.fillText(state.headline,500,300);

  ctx.fillStyle=state.bodyColor;
  ctx.font=`32px ${state.bodyFont}`;
  ctx.fillText(state.body,500,380);

  if(state.logo){
    const img = images[state.logo];
    const w = 160;
    const h = w * (img.height / img.width);
    ctx.drawImage(img,420,760,w,h);
  }
}

function buildSelector(list,el,cb){
  list.forEach((item,i)=>{
    const src = item.src || item;
    loadImage(src).then(draw);
    const img=document.createElement("img");
    img.src=src;
    img.onclick=()=>{
      [...el.children].forEach(c=>c.classList.remove("selected"));
      img.classList.add("selected");
      cb(item);
      draw();
    };
    if(i===0) img.classList.add("selected");
    el.appendChild(img);
  });
}

buildSelector(templates,templateSelector,(t)=>{
  state.template=t.src;
  state.templateTheme=t.theme;
  if(t.theme==="dark"){
    state.headlineColor="#ffffff";
    state.bodyColor="#ffffff";
  }else{
    state.headlineColor="#000000";
    state.bodyColor="#000000";
  }
  headlineColor.value=state.headlineColor;
  bodyColor.value=state.bodyColor;
});

buildSelector(logos,logoSelector,(src)=>state.logo=src);

headline.oninput=e=>{state.headline=e.target.value;draw()};
body.oninput=e=>{state.body=e.target.value;draw()};
headlineColor.oninput=e=>{state.headlineColor=e.target.value;draw()};
bodyColor.oninput=e=>{state.bodyColor=e.target.value;draw()};
headlineFont.onchange=e=>{state.headlineFont=e.target.value;draw()};
bodyFont.onchange=e=>{state.bodyFont=e.target.value;draw()};

sharePNG.onclick=()=>{
  const url = canvas.toDataURL("image/png");
  const win = window.open();
  win.document.write(`<p>Long press or right click the image to save.</p><img src="${url}" style="max-width:100%">`);
};

ensureFonts().then(draw);
</script>
</body>
</html>
